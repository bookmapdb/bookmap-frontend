<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>도서 리스트 - BookMap</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
  <div class="max-w-6xl mx-auto p-6">
    <h1 class="text-3xl font-bold mb-6">📖 도서 리스트</h1>

    <!-- 리스트 컨테이너 -->
    <div id="bookList" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6"></div>

    <!-- 하단 버튼 -->
    <div class="mt-8 flex justify-between">
      <a href="index.html" class="text-blue-600 hover:underline">🏠 홈</a>
      <a href="form.html" class="text-blue-600 hover:underline">➕ 도서 등록</a>
    </div>
  </div>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbygL5W_rVDTMkPIjLiSjDVN5nxRaZgHTIW3vbJgTgOL_Z_IwLF4k97VEd1bQNfxqAs1_A/exec";
    const bookList = document.getElementById("bookList");

    // 도서 리스트 불러오기
    async function fetchBooks() {
      try {
        const res = await fetch(API_URL);
        const books = await res.json();

        bookList.innerHTML = "";

        if (!books.length) {
          bookList.innerHTML = `<p class="text-gray-600">등록된 도서가 없습니다.</p>`;
          return;
        }

        books.forEach(book => {
          const card = document.createElement("div");
          card.className = "bg-white shadow rounded-lg overflow-hidden hover:shadow-lg transition cursor-pointer";

          card.innerHTML = `
            <img src="${book.cover || "https://via.placeholder.com/150x200?text=No+Cover"}" 
                 alt="${book.title}" class="w-full h-56 object-cover">
            <div class="p-4">
              <h2 class="text-lg font-semibold truncate">${book.title}</h2>
              <p class="text-sm text-gray-600">${book.author || ""} ${book.translator ? "/ " + book.translator : ""}</p>
              <p class="text-sm text-gray-500">${book.publisher || ""}</p>
              <p class="text-xs text-gray-400 mt-1">레벨: ${book.level || "-"}</p>
              <p class="text-xs mt-1 px-2 py-1 rounded bg-gray-100 inline-block">${book.status || "대기"}</p>
            </div>
          `;

          // 상세 페이지로 이동
          card.addEventListener("click", () => {
            window.location.href = `book-detail.html?title=${encodeURIComponent(book.title)}`;
          });

          bookList.appendChild(card);
        });
      } catch (err) {
        bookList.innerHTML = `<p class="text-red-600">❌ 데이터를 불러오는데 실패했습니다.</p>`;
      }
    }

    fetchBooks();
  </script>
</body>
</html>
